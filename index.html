<html>
  <script type="text/javascript">
    fetch('https://dixwh3awhptkjeo45pjsj66nhi0siqvq.lambda-url.us-east-1.on.aws/')
      .then(r => r.json().then((result) => document.getElementById('todaysnumber').innerHTML = result))
  </script>
  <script src="https://cdn.jsdelivr.net/npm/ruby-3_2-wasm-wasi@2.0.0/dist/browser.script.iife.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script type="text/ruby">
    # Here we go for today's number.
    require 'js'
    
    class Ball
      def initialize(number)
        @number = number
      end

      def number
        @number
      end
    end

    class Jar
      def initialize(balls)
        @balls = balls
      end

      def swirl_numbers
        puts 'Swirl the numbers...'
      end

      def pick_number
        puts @balls.length
        @balls[Random.rand(@balls.length)]
      end
    end

    # It's Month Day, Year.
    d = Time.now.utc
    srand (((d.month+d.day)**d.year)*13) # Placeholder until I have a server up
    

    # Ten balls. Each ball has a number. Numbers 1 through ten
    balls = (1..10).map { |i| Ball.new(i)}
    jar = Jar.new(balls)

    # Swirl the numbers
    jar.swirl_numbers

    # Pick a number
    ball = jar.pick_number

    # Confetti for good measure
    require 'json'
    oatmilk = '#FCFCFB'
    default_colors = ['#26ccff', '#a25afd', '#ff5e7e', '#88ff5a', '#fcff42', '#ffa62d', '#ff36ff']
    colors = [oatmilk] + default_colors
    confetti_args = {startVelocity: 100, origin: { x: 0.5, y: 0.8}, gravity: 1.5, particleCount: 10000, spread: 270, scalar: 0.5, ticks: 1000, colors: colors}
    confetti2_args = {startVelocity: 50, origin: { x: 0.4, y: 0.8}, particleCount: 1000, spread: 120, decay: 0.9, scalar: 0.8, ticks: 1000, angle: 120, drift: -0.4, colors: colors}
    confetti3_args = {startVelocity: 50, origin: { x: 0.6, y: 0.8}, particleCount: 1000, spread: 120, decay: 0.9, scalar: 0.8, ticks: 1000, angle: 60, drift: 0.4, colors: colors}
    confetti4_args = {startVelocity: 130, origin: { x: 0.5, y: 0.8}, particleCount: 100, spread: 70, gravity: 0.5, scalar: 10, ticks: 1000, colors: colors}
    confetti5_args = {startVelocity: 130, origin: { x: 0.45, y: 0.8}, particleCount: 100, spread: 70, gravity: 0.5, scalar: 10, ticks: 1000, angle: 105, colors: colors}
    confetti6_args = {startVelocity: 130, origin: { x: 0.55, y: 0.8}, particleCount: 100, spread: 70, gravity: 0.5, scalar: 10, ticks: 1000, angle: 75, colors: colors}
    JS.eval("confetti(#{JSON.pretty_generate(confetti_args)})")
    JS.eval("confetti(#{JSON.pretty_generate(confetti2_args)})")
    JS.eval("confetti(#{JSON.pretty_generate(confetti3_args)})")
    JS.eval("confetti(#{JSON.pretty_generate(confetti4_args)})")
    JS.eval("confetti(#{JSON.pretty_generate(confetti5_args)})")
    JS.eval("confetti(#{JSON.pretty_generate(confetti6_args)})")

    # Today's number is...
    todays_number_elem = JS.global[:document].getElementById('todaysnumber')
    JS.global[:document].getElementById('todaysnumber')[:style][:visibility] = 'visible'
  </script>
  <body style="background: black;">
    <div>
      <h2 style="color: white; text-align: center; height: 50%; font-size: 8vw; font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif; letter-spacing: 2vw;">
        TODAY'S</br>NUMBER</br>&nbsp;&nbsp;IS...
      </h2>
      <h5 id="todaysnumber" style="color: red; text-align: center; font-size: 10vh; font-family: cursive; visibility: hidden;"></h5>
    </div>
  </body>
</html>
